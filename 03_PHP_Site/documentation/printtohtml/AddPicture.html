<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>AddPicture.php</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<style type="text/css">
<!--
body {color: #000000; background-color: #ffffff; font-family: Monospaced}
pre {color: #000000; background-color: #ffffff; font-family: Monospaced}
table {color: #000000; background-color: #e9e8e2; font-family: Monospaced}
.ST0 {background-color: #e9eff8; font-family: Monospaced; font-weight: bold}
.ST2 {font-family: Monospaced; font-weight: bold}
.PHP_VARIABLE {color: #6d3206}
.ST1 {color: #009900}
.string {color: #ce7b00}
.keyword {color: #0000e6}
.heredocdelimiter {color: #6c3d03}
-->
</style>
</head>
<body>
<table width="100%"><tr><td align="center">C:\xampp\htdocs\SkyDrive\Assignment3\AddPicture.php</td></tr></table>
<pre>
  1 <span class="ST0">&lt;?php</span>
  2 
  3 <span class="keyword">function</span> badinput(<span class="PHP_VARIABLE">$msg</span>) {
  4     <span class="keyword">echo</span> <span class="heredocdelimiter">&lt;&lt;&lt;BADINPUT</span>
  5 <span class="string">    &lt;!DOCTYPE html&gt;</span>
  6 <span class="string">&lt;html&gt;</span>
  7 <span class="string">    &lt;head&gt;</span>
  8 <span class="string">        &lt;title&gt;Bad Input&lt;/title&gt;</span>
  9 <span class="string">        &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;</span>
 10 <span class="string">    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;./css/style1.css&quot;/&gt;</span>
 11 <span class="string">    &lt;/head&gt;</span>
 12 <span class="string">    &lt;body&gt;</span>
 13 <span class="string">     &lt;div class=&quot;head&quot;&gt;</span>
 14 <span class="string">            &lt;table&gt;</span>
 15 <span class="string">                &lt;tr&gt;</span>
 16 <span class="string">                    &lt;th&gt;&lt;img src=&quot;./siteimages/stack-of-books.jpg&quot;/&gt;&lt;/th&gt;</span>
 17 <span class="string">                    &lt;td&gt;&lt;h1&gt;Illawarra Antiquarian Books&lt;/h1&gt;&lt;/td&gt;</span>
 18 <span class="string">                &lt;/tr&gt;</span>
 19 <span class="string">            &lt;/table&gt;</span>
 20 <span class="string">        &lt;/div&gt;</span>
 21 <span class="string">    &lt;div class=&quot;body&quot;&gt;</span>
 22 <span class="string">        &lt;h1&gt;Error&lt;/h1&gt;</span>
 23 <span class="string">        &lt;fieldset&gt;&lt;h2&gt;Input could not be used because </span><span class="PHP_VARIABLE">$msg</span><span class="string">.&lt;/h2&gt;&lt;/fieldset&gt;</span>
 24 <span class="string">                &lt;/div&gt;&lt;h3&gt;&lt;input type=&#39;button&#39; onclick=&quot;javascript:history.go(-1)&quot; value=&#39;Go Back&#39;/&gt;&lt;/h3&gt;</span>
 25 <span class="string">    &lt;div class=&quot;foot&quot;&gt;</span>
 26 <span class="string">            &lt;a href=&quot;./index.php&quot;&gt;Home&lt;/a&gt;</span>
 27 <span class="string">    &lt;/div&gt;</span>
 28 <span class="string">    &lt;/body&gt;</span>
 29 <span class="string">&lt;/html&gt;</span>
 30 <span class="heredocdelimiter">BADINPUT</span>;
 31 }
 32 
 33 <span class="keyword">function</span> dislay_addpic_form() {
 34     <span class="PHP_VARIABLE">$id</span> = <span class="PHP_VARIABLE">$_GET</span>[<span class="string">&quot;id&quot;</span>];
 35     <span class="PHP_VARIABLE">$mysqli</span> = <span class="keyword">new</span> mysqli(<span class="string">&#39;localhost&#39;</span>, <span class="string">&#39;root&#39;</span>, <span class="string">&#39;&#39;</span>, <span class="string">&#39;iab&#39;</span>);
 36     <span class="PHP_VARIABLE">$stmt</span> = <span class="PHP_VARIABLE">$mysqli</span>-&gt;prepare(<span class="string">&quot;</span><span class="string">select Title, Author, Publisher, Year, Price from Books where Booksid=</span><span class="PHP_VARIABLE">$id</span><span class="string">&quot;</span>);
 37     <span class="PHP_VARIABLE">$stmt</span>-&gt;execute();
 38     <span class="PHP_VARIABLE">$stmt</span>-&gt;bind_result(<span class="PHP_VARIABLE">$title</span>, <span class="PHP_VARIABLE">$author</span>, <span class="PHP_VARIABLE">$publisher</span>, <span class="PHP_VARIABLE">$year</span>, <span class="PHP_VARIABLE">$price</span>);
 39     <span class="PHP_VARIABLE">$stmt</span>-&gt;fetch();
 40     <span class="PHP_VARIABLE">$phpself</span> = <span class="PHP_VARIABLE">$_SERVER</span>[<span class="string">&quot;PHP_SELF&quot;</span>];
 41     <span class="keyword">echo</span> <span class="heredocdelimiter">&lt;&lt;&lt;ADDPICFORM</span>
 42 <span class="string">&lt;!DOCTYPE html&gt;</span>
 43 <span class="string">&lt;html&gt;</span>
 44 <span class="string">    &lt;head&gt;</span>
 45 <span class="string">        &lt;title&gt;</span><span class="PHP_VARIABLE">$title</span><span class="string">&lt;/title&gt;</span>
 46 <span class="string">        &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;</span>
 47 <span class="string">    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;./css/style1.css&quot;/&gt;</span>
 48 <span class="string">        &lt;script type=&quot;text/javascript&quot; src=&quot;./js/confirmdelete.js&quot;&gt;&lt;/script&gt;</span>
 49 <span class="string">    &lt;/head&gt;</span>
 50 <span class="string">    &lt;body&gt;</span>
 51 <span class="string"> &lt;div class=&quot;head&quot;&gt;</span>
 52 <span class="string">            &lt;table&gt;</span>
 53 <span class="string">                &lt;tr&gt;</span>
 54 <span class="string">                    &lt;th&gt;&lt;img src=&quot;./siteimages/stack-of-books.jpg&quot;/&gt;&lt;/th&gt;</span>
 55 <span class="string">                    &lt;td&gt;&lt;h1&gt;Illawarra Antiquarian Books&lt;/h1&gt;&lt;/td&gt;</span>
 56 <span class="string">                &lt;/tr&gt;</span>
 57 <span class="string">            &lt;/table&gt;</span>
 58 <span class="string">        &lt;/div&gt;</span>
 59 <span class="string">    &lt;div class=&quot;body&quot;&gt;</span>
 60 <span class="string">        &lt;h1&gt;</span><span class="PHP_VARIABLE">$title</span><span class="string">&lt;/h1&gt;</span>
 61 <span class="string">        &lt;p&gt;</span><span class="PHP_VARIABLE">$author</span><span class="string">&lt;/p&gt;</span>
 62 <span class="string">        &lt;p&gt;</span><span class="PHP_VARIABLE">$publisher</span><span class="string">&lt;/p&gt;</span>
 63 <span class="string">        &lt;p&gt;</span><span class="PHP_VARIABLE">$year</span><span class="string">&lt;/p&gt;</span>
 64 <span class="string">        &lt;p&gt;$</span><span class="PHP_VARIABLE">$price</span><span class="string">&lt;/p&gt;</span>
 65 <span class="string">        &lt;p&gt;Record id #</span><span class="PHP_VARIABLE">$id</span><span class="string">&lt;/p&gt;</span>
 66 <span class="string">        &lt;form  action=&quot;</span><span class="PHP_VARIABLE">$phpself</span><span class="string">&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;</span>
 67 <span class="string">            &lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;</span><span class="PHP_VARIABLE">$id</span><span class="string">&quot;/&gt;</span>
 68 <span class="string">            &lt;input type=&quot;hidden&quot; name=&quot;MAX_FILE_SIZE&quot; value=&quot;1000000&quot;/&gt;</span>
 69 <span class="string">            &lt;fieldset&gt;</span>
 70 <span class="string">                &lt;legend&gt;&lt;h1&gt;Add picture&lt;/h1&gt;&lt;/legend&gt;</span>
 71 <span class="string">                &lt;h2&gt;Picture(.jpg only)&lt;/h2&gt;&lt;input type=&quot;file&quot; name=&quot;image&quot; accept=&quot;image/jpg&quot; /&gt;</span>
 72 <span class="string">                &lt;h2&gt;Comment with picture&lt;/h2&gt;&lt;textarea name=&quot;comment&quot;&gt;&lt;/textarea&gt;</span>
 73 <span class="string">                &lt;input type=&quot;submit&quot; value=&quot;Add Picture&quot;/&gt;</span>
 74 <span class="string">            &lt;/fieldset&gt;</span>
 75 <span class="string">        &lt;/form&gt;</span>
 76 <span class="string">        &lt;form action=&quot;Update.php&quot; method=&quot;POST&quot;&gt;</span>
 77 <span class="string">        &lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;</span><span class="PHP_VARIABLE">$id</span><span class="string">&quot;/&gt;</span>
 78 <span class="string">    &lt;input type=&quot;hidden&quot; name=&quot;price&quot; value=&quot;</span><span class="PHP_VARIABLE">$price</span><span class="string">&quot;/&gt;</span>
 79 <span class="string">            &lt;fieldset&gt;</span>
 80 <span class="string">                &lt;legend&gt;&lt;h1&gt;Update price&lt;/h1&gt;&lt;/legend&gt;</span>
 81 <span class="string">                &lt;h2&gt;New price&lt;/h2&gt;&lt;input type=&quot;text&quot; name=&quot;nprice&quot;/&gt;</span>
 82 <span class="string">                &lt;input type=&quot;submit&quot; value=&quot;Update price&quot;/&gt;</span>
 83 <span class="string">            &lt;/fieldset&gt;</span>
 84 <span class="string">        &lt;/form&gt;</span>
 85 <span class="string">        &lt;form&gt;</span>
 86 <span class="string">        &lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;</span><span class="PHP_VARIABLE">$id</span><span class="string">&quot;/&gt;</span>
 87 <span class="string">            &lt;fieldset&gt;</span>
 88 <span class="string">            &lt;legend&gt;&lt;h1&gt;Delete record&lt;/h1&gt;&lt;/legend&gt;</span>
 89 <span class="string">                &lt;input type=&quot;button&quot; onclick=&quot;return confirmdelete(</span><span class="PHP_VARIABLE">$id</span><span class="string">)&quot; value=&quot;Delete record&quot;/&gt;</span>
 90                     
 91 <span class="string">            &lt;/fieldset&gt;</span>
 92 <span class="string">        &lt;/form&gt;</span>
 93 <span class="string">        &lt;h3&gt;&lt;input type=&#39;button&#39; onclick=&quot;javascript:history.go(-1)&quot; value=&#39;Go Back&#39;/&gt;&lt;/h3&gt;&lt;/fieldset&gt;</span>
 94 <span class="string">    &lt;/div&gt;</span>
 95 <span class="string">    &lt;div class=&quot;foot&quot;&gt;</span>
 96 <span class="string">            &lt;a href=&quot;./index.php&quot;&gt;Home&lt;/a&gt;</span>
 97 <span class="string">    &lt;/div&gt;</span>
 98 <span class="string">    &lt;/body&gt;</span>
 99 <span class="string">&lt;/html&gt;</span>
100 <span class="heredocdelimiter">ADDPICFORM</span>;
101     <span class="PHP_VARIABLE">$stmt</span>-&gt;close();
102     <span class="PHP_VARIABLE">$mysqli</span>-&gt;close();
103 }
104 
105 <span class="keyword">function</span> connectToDatabase() {
106     <span class="keyword">global</span> <span class="PHP_VARIABLE">$mysqli</span>;
107     <span class="PHP_VARIABLE">$mysqli</span> = <span class="keyword">new</span> mysqli(<span class="string">&#39;localhost&#39;</span>, <span class="string">&#39;root&#39;</span>, <span class="string">&#39;&#39;</span>, <span class="string">&#39;iab&#39;</span>);
108 
109     <span class="keyword">if</span> (mysqli_connect_errno()) {
110         <span class="PHP_VARIABLE">$problem</span> = mysqli_connect_error();
111         badinput(<span class="PHP_VARIABLE">$problem</span>);
112         <span class="keyword">exit</span>;
113     }
114 }
115 
116 <span class="keyword">function</span> add_picture() {
117     <span class="keyword">global</span> <span class="PHP_VARIABLE">$mysqli</span>;
118     <span class="PHP_VARIABLE">$error</span> = <span class="PHP_VARIABLE">$_FILES</span>[<span class="string">&quot;image&quot;</span>][<span class="string">&quot;error&quot;</span>];
119     <span class="keyword">if</span> (<span class="PHP_VARIABLE">$error</span> != UPLOAD_ERR_OK) {
120         <span class="keyword">echo</span> <span class="heredocdelimiter">&lt;&lt;&lt;NOLUCK</span>
121 <span class="string">        &lt;html&gt;</span>
122 <span class="string">        &lt;head&gt;&lt;title&gt;File Upload Failed&lt;/title&gt;</span>
123 <span class="string">        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;./css/style1.css&quot;/&gt;&lt;/head&gt;</span>
124 <span class="string">        &lt;body&gt;</span>
125 <span class="string">         &lt;div class=&quot;head&quot;&gt;</span>
126 <span class="string">            &lt;table&gt;</span>
127 <span class="string">                &lt;tr&gt;</span>
128 <span class="string">                    &lt;th&gt;&lt;img src=&quot;./siteimages/stack-of-books.jpg&quot;/&gt;&lt;/th&gt;</span>
129 <span class="string">                    &lt;td&gt;&lt;h1&gt;Illawarra Antiquarian Books&lt;/h1&gt;&lt;/td&gt;</span>
130 <span class="string">                &lt;/tr&gt;</span>
131 <span class="string">            &lt;/table&gt;</span>
132 <span class="string">        &lt;/div&gt;</span>
133 <span class="string">    &lt;div class=&quot;body&quot;&gt;</span>
134 <span class="string">        &lt;h1&gt;Upload Failed&lt;/h1&gt;</span>
135 <span class="string">        &lt;fieldset&gt;&lt;h2&gt;The upload attempt failed. The error code was </span><span class="PHP_VARIABLE">$error</span><span class="string">. &lt;/h2&gt;&lt;/fieldset&gt;</span>
136 <span class="string">    &lt;/div&gt;&lt;h3&gt;&lt;input type=&#39;button&#39; onclick=&quot;javascript:history.go(-1)&quot; value=&#39;Go Back&#39;/&gt;&lt;/h3&gt;</span>
137 <span class="string">    &lt;div class=&quot;foot&quot;&gt;</span>
138 <span class="string">            &lt;a href=&quot;./index.php&quot;&gt;Home&lt;/a&gt;</span>
139 <span class="string">    &lt;/div&gt;</span>
140 <span class="string">        &lt;/body&gt;</span>
141 <span class="string">        &lt;html&gt;</span>
142 <span class="heredocdelimiter">NOLUCK</span>;
143         <span class="keyword">exit</span>;
144     }
145     <span class="PHP_VARIABLE">$filename</span> = <span class="PHP_VARIABLE">$_FILES</span>[<span class="string">&#39;image&#39;</span>][<span class="string">&#39;tmp_name&#39;</span>];
146     <span class="PHP_VARIABLE">$comment</span> = <span class="PHP_VARIABLE">$_POST</span>[<span class="string">&quot;comment&quot;</span>];
147     <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="PHP_VARIABLE">$comment</span>)) {
148         badinput(<span class="string">&quot; need comment&quot;</span>);
149         <span class="keyword">exit</span>;
150     }
151     <span class="PHP_VARIABLE">$pat</span> = <span class="string">&#39;/^[a-zA-Z0-9\s&quot;\.;,:!?()]+$/&#39;</span>;
152     <span class="keyword">if</span> (!preg_match(<span class="PHP_VARIABLE">$pat</span>, <span class="PHP_VARIABLE">$comment</span>)) {
153         badinput(<span class="string">&quot;invalid data&quot;</span>);
154         <span class="keyword">exit</span>;
155     }
156 
157     <span class="PHP_VARIABLE">$numbytes</span> = filesize(<span class="PHP_VARIABLE">$filename</span>);
158     <span class="PHP_VARIABLE">$handle</span> = fopen(<span class="PHP_VARIABLE">$filename</span>, <span class="string">&quot;r&quot;</span>);
159     <span class="keyword">if</span> (!<span class="PHP_VARIABLE">$handle</span>) {
160         badinput(<span class="string">&quot;Failed to open file&quot;</span>);
161         <span class="keyword">exit</span>;
162     }
163     <span class="PHP_VARIABLE">$imagedata</span> = addslashes(fread(<span class="PHP_VARIABLE">$handle</span>, <span class="PHP_VARIABLE">$numbytes</span>));
164     <span class="keyword">if</span> (!<span class="PHP_VARIABLE">$imagedata</span>) {
165         badinput(<span class="string">&quot;Failed to read image&quot;</span>);
166         <span class="keyword">exit</span>;
167     }
168     fclose(<span class="PHP_VARIABLE">$handle</span>);
169 
170     connectToDatabase();
171     <span class="PHP_VARIABLE">$id</span> = <span class="PHP_VARIABLE">$_POST</span>[<span class="string">&quot;id&quot;</span>];
172     <span class="PHP_VARIABLE">$stmt</span> = <span class="PHP_VARIABLE">$mysqli</span>-&gt;prepare(<span class="string">&quot;</span><span class="string">select Genre from Books where Booksid=</span><span class="PHP_VARIABLE">$id</span><span class="string">&quot;</span>);
173     <span class="PHP_VARIABLE">$stmt</span>-&gt;execute();
174     <span class="PHP_VARIABLE">$stmt</span>-&gt;bind_result(<span class="PHP_VARIABLE">$genre</span>);
175     <span class="PHP_VARIABLE">$stmt</span>-&gt;fetch();
176 
177     <span class="PHP_VARIABLE">$file_name</span> = <span class="PHP_VARIABLE">$_FILES</span>[<span class="string">&#39;image&#39;</span>][<span class="string">&#39;name&#39;</span>];
178     <span class="PHP_VARIABLE">$random_digit</span> = rand(0000, 9999);
179     <span class="PHP_VARIABLE">$new_file_name</span> = <span class="PHP_VARIABLE">$random_digit</span> . <span class="PHP_VARIABLE">$file_name</span>;
180     <span class="PHP_VARIABLE">$path</span> = <span class="string">&quot;uploadedimages/&quot;</span> . <span class="PHP_VARIABLE">$genre</span> . <span class="string">&quot;/&quot;</span> . <span class="PHP_VARIABLE">$new_file_name</span>;
181     <span class="keyword">if</span> (<span class="PHP_VARIABLE">$_FILES</span>[<span class="string">&quot;image&quot;</span>]) {
182         copy(<span class="PHP_VARIABLE">$_FILES</span>[<span class="string">&#39;image&#39;</span>][<span class="string">&#39;tmp_name&#39;</span>], <span class="PHP_VARIABLE">$path</span>);
183     }
184     <span class="PHP_VARIABLE">$mysqli</span>-&gt;close();
185 
186     connectToDatabase();
187     <span class="PHP_VARIABLE">$query</span> = <span class="string">&quot;</span><span class="string">insert into Pictures values(null, &#39;</span><span class="PHP_VARIABLE">$id</span><span class="string">&#39;, &#39;</span><span class="PHP_VARIABLE">$comment</span><span class="string">&#39;, &#39;</span><span class="PHP_VARIABLE">$path</span><span class="string">&#39;)</span><span class="string">&quot;</span>;
188     <span class="PHP_VARIABLE">$mysqli</span>-&gt;query(<span class="PHP_VARIABLE">$query</span>);
189     <span class="PHP_VARIABLE">$errorreport</span> = <span class="PHP_VARIABLE">$mysqli</span>-&gt;<span class="ST1">error</span>;
190 
191     <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="PHP_VARIABLE">$errorreport</span>)) {
192         <span class="keyword">echo</span> <span class="heredocdelimiter">&lt;&lt;&lt;FAILRESPONSE</span>
193 <span class="string">      &lt;html&gt;</span>
194 <span class="string">      &lt;head&gt;&lt;title&gt;Failure Page&lt;/title&gt;</span>
195 <span class="string">        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;./css/style1.css&quot;/&gt;&lt;/head&gt;</span>
196 <span class="string">      &lt;body&gt;</span>
197 <span class="string">         &lt;div class=&quot;head&quot;&gt;</span>
198 <span class="string">            &lt;table&gt;</span>
199 <span class="string">                &lt;tr&gt;</span>
200 <span class="string">                    &lt;th&gt;&lt;img src=&quot;./siteimages/stack-of-books.jpg&quot;/&gt;&lt;/th&gt;</span>
201 <span class="string">                    &lt;td&gt;&lt;h1&gt;Illawarra Antiquarian Books&lt;/h1&gt;&lt;/td&gt;</span>
202 <span class="string">                &lt;/tr&gt;</span>
203 <span class="string">            &lt;/table&gt;</span>
204 <span class="string">        &lt;/div&gt;</span>
205 <span class="string">    &lt;div class=&quot;body&quot;&gt;</span>
206 <span class="string">        &lt;h1&gt;Database update failed&lt;/h1&gt;</span>
207 <span class="string">      &lt;fieldset&gt;&lt;h2&gt;</span><span class="PHP_VARIABLE">$errorreport</span><span class="string">.&lt;/h2&gt;&lt;/fieldset&gt;</span>
208 <span class="string">              &lt;/div&gt;&lt;h3&gt;&lt;input type=&#39;button&#39; onclick=&quot;javascript:history.go(-1)&quot; value=&#39;Go Back&#39;/&gt;&lt;/h3&gt;</span>
209 <span class="string">    &lt;div class=&quot;foot&quot;&gt;</span>
210 <span class="string">            &lt;a href=&quot;./index.php&quot;&gt;Home&lt;/a&gt;</span>
211 <span class="string">    &lt;/div&gt;</span>
212 <span class="string">      &lt;/body&gt;</span>
213 <span class="string">      &lt;/html&gt;</span>
214 <span class="heredocdelimiter">FAILRESPONSE</span>;
215     } <span class="keyword">else</span> {
216         <span class="PHP_VARIABLE">$result</span> = <span class="PHP_VARIABLE">$mysqli</span>-&gt;query(<span class="string">&quot;SELECT LAST_INSERT_ID()&quot;</span>);
217         <span class="PHP_VARIABLE">$row</span> = <span class="PHP_VARIABLE">$result</span>-&gt;fetch_row();
218         <span class="PHP_VARIABLE">$ident</span> = <span class="PHP_VARIABLE">$row</span>[0];
219         <span class="keyword">echo</span> <span class="heredocdelimiter">&lt;&lt;&lt;SUCCESSRESPONSE</span>
220 <span class="string">      &lt;html&gt;</span>
221 <span class="string">      &lt;head&gt;&lt;title&gt;New Picture Record Inserted&lt;/title&gt;</span>
222 <span class="string">        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;./css/style1.css&quot;/&gt;</span>
223 <span class="string">        &lt;/head&gt;</span>
224 <span class="string">        &lt;body&gt;</span>
225 <span class="string">             &lt;div class=&quot;head&quot;&gt;</span>
226 <span class="string">            &lt;table&gt;</span>
227 <span class="string">                &lt;tr&gt;</span>
228 <span class="string">                    &lt;th&gt;&lt;img src=&quot;./siteimages/stack-of-books.jpg&quot;/&gt;&lt;/th&gt;</span>
229 <span class="string">                    &lt;td&gt;&lt;h1&gt;Illawarra Antiquarian Books&lt;/h1&gt;&lt;/td&gt;</span>
230 <span class="string">                &lt;/tr&gt;</span>
231 <span class="string">            &lt;/table&gt;</span>
232 <span class="string">        &lt;/div&gt;</span>
233 <span class="string">    &lt;div class=&quot;body&quot;&gt;</span>
234 <span class="string">        &lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;</span><span class="PHP_VARIABLE">$ident</span><span class="string">&quot;/&gt;</span>
235 <span class="string">                &lt;h1&gt;New Picture Record Created&lt;/h1&gt;</span>
236 <span class="string">                &lt;p&gt;Picture is record #</span><span class="PHP_VARIABLE">$ident</span><span class="string">.&lt;/p&gt;&lt;br/&gt;</span>
237 <span class="string">                &lt;h3&gt;&lt;input type=&#39;button&#39; onclick=&quot;window.location.href=&#39;./AddPicture.php?id=</span><span class="PHP_VARIABLE">$id</span><span class="string">&#39;&quot; value=&#39;Add another picture&#39;/&gt;</span>
238 <span class="string">&lt;input type=&#39;button&#39; onclick=&quot;window.location.href=&#39;./Details.php?id=</span><span class="PHP_VARIABLE">$id</span><span class="string">&#39;&quot; value=&#39;View Book&#39;/&gt;&lt;/h3&gt;</span>
239 <span class="string">            &lt;/div&gt;</span>
240 <span class="string">            &lt;div class=&quot;foot&quot;&gt;</span>
241 <span class="string">                &lt;a href=&quot;./index.php&quot;&gt;Home&lt;/a&gt;</span>
242 <span class="string">            &lt;/div&gt;</span>
243 <span class="string">        &lt;/body&gt;</span>
244 <span class="string">      &lt;/html&gt;</span>
245 <span class="heredocdelimiter">SUCCESSRESPONSE</span>;
246     }
247     <span class="PHP_VARIABLE">$mysqli</span>-&gt;close();
248 }
249 
250 session_start();
251 <span class="PHP_VARIABLE">$uname</span> = <span class="PHP_VARIABLE">$_SESSION</span>[<span class="string">&quot;vendorusername&quot;</span>];
252 <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="PHP_VARIABLE">$uname</span>)) {
253     header(<span class="string">&quot;Location: VendorLogin.php&quot;</span>);
254     <span class="keyword">exit</span>;
255 }
256 <span class="PHP_VARIABLE">$method</span> = <span class="PHP_VARIABLE">$_SERVER</span>[<span class="string">&quot;REQUEST_METHOD&quot;</span>];
257 <span class="keyword">if</span> (<span class="PHP_VARIABLE">$method</span> == <span class="string">&quot;POST&quot;</span>) {
258     add_picture();
259 } <span class="keyword">else</span> {
260     dislay_addpic_form();
261 }
262 <span class="ST2">?&gt;</span>
263 
</pre></body>
</html>
